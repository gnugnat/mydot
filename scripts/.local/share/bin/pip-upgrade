#!/usr/bin/env python


# Upgrade python packages installed with pip under the active user.


import subprocess


try:
    import pip
except ImportError:
    import sys
    sys.exit("No pip on the system!")


def main():

    pkgs = eval(str(subprocess.run(
        "pip list --user --outdated --format=json", shell=True,
        stdout=subprocess.PIPE).stdout, encoding='utf-8'))

    for pkg in pkgs:
        print("upgrading", pkg['name'])
        subprocess.run(
            "pip install --user --upgrade " + pkg['name'], shell=True)


if __name__ == "__main__":
    main()
