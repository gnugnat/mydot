#!/usr/bin/env python


"""
This file is part of mydot.

mydot is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

mydot is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with mydot.  If not, see <https://www.gnu.org/licenses/>.

Copyright (c) 2020, XGQT
Licensed under the GNU GPL v3 License

Upgrade python packages installed with pip under the active user.
"""


import subprocess


try:
    import pip
except ImportError:
    import sys
    sys.exit("No pip on the system!")


def main():

    pkgs = eval(str(subprocess.run(
        "pip list --user --outdated --format=json",
        shell=True, check=True,
        stdout=subprocess.PIPE).stdout, encoding='utf-8'))

    for pkg in pkgs:
        print("upgrading", pkg['name'])
        subprocess.run(
            "pip install --user --upgrade " + pkg['name'],
            shell=True, check=True)


if __name__ == "__main__":
    main()
